webpackJsonp([1],{NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var s=n("VU/8")({name:"App"},r,!1,function(t){n("gsu9")},null,null).exports,o=n("/ocq"),i=n("NYxO"),c=n("BO1k"),u=n.n(c),d=n("mtWM"),l=n.n(d),p="http://localhost:8000/calculate";var v={state:{debtData:[{date:"2015/09/25",value:"700000",type:"debt"},{date:"2015/11/16",value:"160000",type:"repayment"},{date:"2015/12/12",value:"100000",type:"repayment"},{date:"2016/01/20",value:"440000",type:"repayment"},{date:"2016/02/12",value:"50000",type:"debt"},{date:"2016/04/08",value:"50000",type:"repayment"}],debtData2:[{date:"2016/06/02",value:"100",type:"debt"},{date:"2016/10/2",value:"100000",type:"debt"},{date:"2016/11/14",value:"100000",type:"repayment"},{date:"2016/012/27",value:"100",type:"repayment"}],debtOptions:{date:"",percents:""}},getters:{debtData:function(t){return t.debtData.sort(function(t,e){return new Date(t.date)-new Date(e.date)})},debtOptions:function(t){return t.debtOptions}},actions:{loadData:function(t,e){var n,a=t.commit;console.log(e,"id"),(n=e,l.a.get(p+"/get_data",{params:{id:n}})).then(function(t){a("setData",t.data)})}},mutations:{setCalcOptions:function(t,e){t.debtOptions.date=e.date,t.debtOptions.percents=e.percents},setData:function(t,e){for(console.log(t.debtData,"dd");t.debtData.length;)t.debtData.pop();t.debtData.length=0;var n=!0,a=!1,r=void 0;try{for(var s,o=u()(e);!(n=(s=o.next()).done);n=!0){var i=s.value;t.debtData.push(i.fields)}}catch(t){a=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw r}}console.log(t.debtData,"dd")}}};a.a.use(i.a);var f=new i.a.Store({modules:{calculate:v}}),h={props:["data"],methods:{},computed:{formatDate:function(){return new Date(this.data.date).toLocaleString("ru",{year:"numeric",month:"long",day:"numeric"})},debt:function(){return"debt"===this.data.type.toLowerCase()?this.data.value:""},repayment:function(){return"repayment"===this.data.type.toLowerCase()?this.data.value:""}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("td",[t._v(t._s(t.formatDate))]),t._v(" "),n("td",[t._v(t._s(t.debt))]),t._v(" "),n("td",[t._v(t._s(t.repayment))])])},staticRenderFns:[]};var b={components:{TableLine:n("VU/8")(h,m,!1,function(t){n("QPjE")},"data-v-35263682",null).exports},name:"debt",data:function(){return{}},methods:{},created:function(){},computed:{debtData:function(){return this.$store.getters.debtData},debtSum:function(){return this.debtData.filter(function(t){return"debt"===t.type.toLowerCase()}).reduce(function(t,e){return t+parseInt(e.value)},0)},repayment:function(){return this.debtData.filter(function(t){return"repayment"===t.type.toLowerCase()}).reduce(function(t,e){return t+parseInt(e.value)},0)}}},_={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",{staticClass:"table"},[t._m(0),t._v(" "),n("tbody",[t._l(t.debtData,function(t,e){return n("table-line",{key:e,attrs:{data:t}})}),t._v(" "),n("tr",[n("td"),t._v(" "),n("td",[t._v(t._s(this.debtSum))]),t._v(" "),n("td",[t._v(t._s(this.repayment))])])],2)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",{staticClass:"thead-dark"},[e("tr",[e("th",{attrs:{scope:"col"}},[this._v("Дата")]),this._v(" "),e("th",{attrs:{scope:"col"}},[this._v("Поступление основного долга")]),this._v(" "),e("th",{attrs:{scope:"col"}},[this._v("Погашение основного долга")])])])}]};var g=n("VU/8")(b,_,!1,function(t){n("ksT+")},"data-v-8462f072",null).exports,y=n("Xxa5"),D=n.n(y),w=D.a.mark(O);function x(t,e){var n=[],a=function(t){for(var e=[],n=0,a=0;a<t.length;a++)n+=parseInt(t[a].value)*("debt"===t[a].type.toLowerCase()?1:-1),void 0!==t[a+1]&&e.push({value:n,start:new Date(t[a].date),end:new Date(t[a+1].date)});return console.log(e,"result"),e}(t),r=!0,s=!1,o=void 0;try{for(var i,c=u()(O(a[0].start,a[a.length-1].end,e));!(r=(i=c.next()).done);r=!0){var d=i.value,l=0,p=!0,v=!1,f=void 0;try{for(var h,m=u()(a);!(p=(h=m.next()).done);p=!0){var b=h.value;if(F(d.start,d.end,b))l+=P(d.start,d.end,b,e);else if(l>0)break}}catch(t){v=!0,f=t}finally{try{!p&&m.return&&m.return()}finally{if(v)throw f}}n.push({date:d.end,percents:Math.round(100*l)/100})}}catch(t){s=!0,o=t}finally{try{!r&&c.return&&c.return()}finally{if(s)throw o}}return n}function k(t,e){return C(t.getFullYear(),t.getMonth()-1,e.date)}function T(t,e){return C(t.getFullYear(),t.getMonth(),e.date)}function C(t,e,n){var a=function(t,e){return new Date(t,e+1,0).getDate()}(t,e);return new Date(t,e,a>n?n:a)}function P(t,e,n,a){var r=t>n.start?t:n.start,s=e<n.end?e:n.end;return Math.round(Math.abs((r.getTime()-s.getTime())/864e5))*function(t,e,n){return t*n/100/function(t){return t%400==0||t%100!=0&&t%4==0?366:365}(e)}(n.value,s.getFullYear(),a.percents)}function F(t,e,n){return t.getTime()<=n.end.getTime()&&t.getTime()>=n.start.getTime()||e.getTime()>n.start.getTime()&&e.getTime()<n.end.getTime()||t.getTime()<n.start.getTime()&&e.getTime()>n.end.getTime()}function O(t,e,n){var a,r;return D.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:a=void 0,r=void 0,t.getDate()<=n.date?(a=new Date(t.getFullYear(),t.getMonth(),1),r=new Date(e.getFullYear(),e.getMonth(),1)):(a=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getFullYear(),e.getMonth()+1,1));case 2:if(!(a<r)){s.next=8;break}return s.next=5,{start:k(a,n),end:T(a,n)};case 5:a=new Date(a.getFullYear(),a.getMonth()+1,1),s.next=2;break;case 8:return s.next=10,{start:k(a,n),end:e};case 10:case"end":return s.stop()}},w,this)}var $={props:["data"],methods:{},computed:{formatDate:function(){return new Date(this.data.date).toLocaleString("ru",{year:"numeric",month:"long",day:"numeric"})}}},S={render:function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v(this._s(this.formatDate))]),this._v(" "),e("td",[this._v(this._s(this.data.percents))])])},staticRenderFns:[]};var M={components:{PercentsLine:n("VU/8")($,S,!1,function(t){n("bGSI")},"data-v-c46cb38c",null).exports},name:"debt",data:function(){return{}},computed:{debtData:function(){return this.$store.getters.debtData},debtOptions:function(){return this.$store.getters.debtOptions},percentsData:function(){return""!==this.debtOptions.date&&""!==this.debtOptions.percents?x(this.debtData,this.debtOptions):[]},percentsSum:function(){return Math.round(100*this.percentsData.reduce(function(t,e){return t+e.percents},0))/100}}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",{staticClass:"table"},[t._m(0),t._v(" "),n("tbody",[t._l(t.percentsData,function(t,e){return n("percents-line",{key:e,attrs:{data:t}})}),t._v(" "),n("tr",[n("td"),t._v(" "),n("td",[t._v(t._s(this.percentsSum))])])],2)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",{staticClass:"thead-dark"},[e("tr",[e("th",{attrs:{scope:"col"}},[this._v("Дата")]),this._v(" "),e("th",{attrs:{scope:"col"}},[this._v("Начисленно за месяц")])])])}]};var U=n("VU/8")(M,E,!1,function(t){n("V2iK")},"data-v-c6157112",null).exports,L={data:function(){return{options:{date:"",percents:""},messageDate:"",messagePercent:""}},methods:{onBtnClicked:function(){console.log("clicked"),this.validateDate()==this.validatePercents()==0?(this.message="",this.$store.commit("setCalcOptions",this.options)):this.message="Неправильные данные"},validateDate:function(){var t=parseInt(this.options.date)&&this.options.date>0&&this.options.date<=31;return this.messageDate=t?"":"Необходимо ввести целое число в диапазоне 1..31",t},validatePercents:function(){var t=parseFloat(this.options.percents)&&this.options.percents>=0;this.messagePercent=t?"":"Необходимо ввести положительное число"}}},V={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",[n("b",[t._v("Дата начисления процентов:")]),n("br"),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.options.date,expression:"options.date"}],attrs:{type:"text",size:"40"},domProps:{value:t.options.date},on:{input:function(e){e.target.composing||t.$set(t.options,"date",e.target.value)}}})]),t._v(" "),n("p",[n("b",[t._v(t._s(t.messageDate))]),n("br")]),t._v(" "),n("p",[n("b",[t._v("Процентная ставка(годовые):")]),n("br"),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.options.percents,expression:"options.percents"}],attrs:{type:"text",size:"40"},domProps:{value:t.options.percents},on:{input:function(e){e.target.composing||t.$set(t.options,"percents",e.target.value)}}})]),t._v(" "),n("p",[n("b",[t._v(t._s(t.messagePercent))]),n("br")]),t._v(" "),n("input",{attrs:{type:"button",size:"40",value:"Расчитать"},on:{click:t.onBtnClicked}})])},staticRenderFns:[]};var Y={components:{DebtTable:g,CalcOptions:n("VU/8")(L,V,!1,function(t){n("PlhS")},"data-v-30c5c971",null).exports,PercentsTable:U},name:"debt",data:function(){return{}},methods:{onUserClicked:function(t){this.$store.dispatch("loadData",t)}}},R={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("input",{attrs:{type:"button",value:"user1"},on:{click:function(e){t.onUserClicked(1)}}}),t._v(" "),n("input",{attrs:{type:"button",value:"user2"},on:{click:function(e){t.onUserClicked(2)}}}),t._v(" "),n("debt-table",{staticStyle:{float:"left",width:"70%"}}),t._v(" "),n("calc-options",{staticStyle:{float:"left",width:"25%",padding:"20px"}}),t._v(" "),n("percents-table",{staticStyle:{width:"70%","padding-top":"300px"}})],1)},staticRenderFns:[]};var I=n("VU/8")(Y,R,!1,function(t){n("wcPm")},"data-v-2da287dd",null).exports;a.a.use(o.a);var N=new o.a({routes:[{path:"/",name:"DebtPage",component:I}]});a.a.config.productionTip=!1,new a.a({el:"#app",router:N,store:f,components:{App:s},template:"<App/>"})},PlhS:function(t,e){},QPjE:function(t,e){},V2iK:function(t,e){},bGSI:function(t,e){},gsu9:function(t,e){},"ksT+":function(t,e){},wcPm:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.1d9811e4e567585682ba.js.map