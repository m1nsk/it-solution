webpackJsonp([1],{"1/oy":function(t,e){},Id91:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var r=s("VU/8")({name:"App"},n,!1,function(t){s("gsu9")},null,null).exports,i=s("/ocq"),o=s("NYxO"),c=s("mtWM"),u=s.n(c),m="http://127.0.0.1:8000/api";var g={state:{messages:[]},getters:{messagesOutOfSpace:function(t){return t.messages}},actions:{getMessages:function(t){var e,s=t.commit;u.a.get(m+"/get_messages",{params:e}).then(function(t){s("setMessages",t.data)})},setMessageStatus:function(t,e){var s,a=this;console.log(e),(s={id:e},u.a.get(m+"/mark_read",{params:s})).then(function(t){a.dispatch("getMessages")})}},mutations:{setMessages:function(t,e){t.messages=e}}};a.a.use(o.a);var p=new o.a.Store({modules:{messages:g}}),d={props:["messageData"],methods:{onStatusClicked:function(){p.dispatch("setMessageStatus",this.messageData.pk)}},computed:{formatDate:function(){return new Date(this.messageData.fields.date).toLocaleString("ru",{year:"numeric",month:"long",day:"numeric",timezone:"UTC",hour:"numeric",minute:"numeric",second:"numeric"})}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("th",{attrs:{scope:"row"}},[t._v(t._s(t.messageData.pk))]),t._v(" "),s("td",[t._v(t._s(t.formatDate))]),t._v(" "),s("td",[t._v(t._s(t.messageData.fields.body))]),t._v(" "),s("td",[s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){t.onStatusClicked()}}},[t._v("Прочитано")])])])},staticRenderFns:[]};var l={components:{Message:s("VU/8")(d,f,!1,function(t){s("gYeV")},"data-v-2b8bce32",null).exports},name:"Messages",data:function(){return{timer:null}},methods:{getMessages:function(){p.dispatch("getMessages")}},created:function(){this.getMessages(),this.timer=setInterval(this.getMessages,1e4)},computed:{messages:function(){return p.getters.messagesOutOfSpace}}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("table",{staticClass:"table"},[this._m(0),this._v(" "),e("tbody",this._l(this.messages,function(t){return e("message",{key:t.date,attrs:{messageData:t}})}))])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",{staticClass:"thead-dark"},[e("tr",[e("th",{attrs:{scope:"col"}},[this._v("#")]),this._v(" "),e("th",{attrs:{scope:"col"}},[this._v("Дата")]),this._v(" "),e("th",{attrs:{scope:"col"}},[this._v("Сообщение")]),this._v(" "),e("th",{attrs:{scope:"col"}},[this._v("Статус")])])])}]};var v=s("VU/8")(l,h,!1,function(t){s("t/17")},"data-v-31cdc6b4",null).exports;a.a.use(i.a);var _=new i.a({routes:[{path:"/",name:"MessagesOutOfSpace",component:v}]}),M=s("e6fC"),b=s("Rf8U"),k=s.n(b);a.a.config.productionTip=!1,a.a.use(M.a),a.a.use(k.a,u.a),new a.a({el:"#app",store:p,router:_,components:{App:r},template:"<App/>"})},gYeV:function(t,e){},gsu9:function(t,e){},"t/17":function(t,e){},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.19ec4b870d7593ad17ed.js.map